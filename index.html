<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PF Saathi - Your Provident Fund, Simplified!</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            /* New gradient background for a "Strips" look */
            background: linear-gradient(135deg, #e0ffe0, #e6f7ff); /* Light green to light blue */
            background-attachment: fixed; /* Ensures background stays fixed during scroll */
        }
        /* Custom styles for the message box */
        .message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #4CAF50; /* Green */
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            display: none; /* Hidden by default */
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }
        .message-box.error {
            background-color: #f44336; /* Red */
        }
        .message-box.show {
            display: block;
            opacity: 1;
        }

        /* Styles for the info modals */
        .info-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.6);
            display: none; /* Changed to none by default */
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }
        .info-modal-overlay.show {
            display: flex; /* Changed to flex when shown */
            opacity: 1;
            visibility: visible;
        }
        .info-modal-content {
            background-color: white;
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
            max-width: 500px;
            width: 90%;
            position: relative;
            transform: translateY(-20px);
            transition: transform 0.3s ease-in-out;
        }
        .info-modal-overlay.show .info-modal-content {
            transform: translateY(0);
        }
        .info-modal-close-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #6b7280; /* Tailwind gray-500 */
        }
        .info-modal-close-btn:hover {
            color: #1f2937; /* Tailwind gray-900 */
        }

        /* Blinking animation for rejection chances */
        @keyframes blink {
            0% { opacity: 1; }
            50% { opacity: 0; }
            100% { opacity: 1; }
        }
        .blinking-text {
            animation: blink 1s infinite;
        }
    </style>
</head>
<body class="antialiased">
    <div class="min-h-screen flex flex-col">

        <!-- Header Section -->
        <header class="bg-gradient-to-r from-emerald-600 to-green-700 text-white shadow-lg py-4 px-6 md:px-12 rounded-b-xl">
            <div class="container mx-auto flex flex-col md:flex-row items-center justify-between">
                <div class="text-3xl md:text-4xl font-extrabold mb-2 md:mb-0">
                    PF Saathi
                </div>
                <nav class="text-xl md:text-2xl font-medium text-center md:text-right">
                    Your Provident Fund, Simplified!
                </nav>
            </div>
        </header>

        <!-- Main Content Area -->
        <main id="main-content" class="flex-grow container mx-auto px-4 py-8 md:py-16">

            <!-- Initial Landing Page Content -->
            <div id="landing-page-content">

                <!-- New: What do you want to do today? Section -->
                <section class="bg-white bg-opacity-90 p-6 md:p-10 rounded-xl shadow-md mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold text-center text-gray-900 mb-8">What do you want to do today?</h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div id="action-check-balance" class="bg-green-50 p-6 rounded-lg shadow-sm text-center cursor-pointer hover:shadow-lg transition duration-300 ease-in-out transform hover:-translate-y-1">
                            <div class="text-4xl text-emerald-600 mb-4">üí∞</div>
                            <h3 class="text-xl font-semibold text-gray-800 mb-2">Check my PF Balance</h3>
                            <p class="text-gray-600">View your current Provident Fund balance.</p>
                        </div>
                        <div id="action-check-data-score" class="bg-lime-50 p-6 rounded-lg shadow-sm text-center cursor-pointer hover:shadow-lg transition duration-300 ease-in-out transform hover:-translate-y-1">
                            <div class="text-4xl text-lime-600 mb-4">üìà</div>
                            <h3 class="text-xl font-semibold text-gray-800 mb-2">Check my PF Data Score</h3>
                            <p class="text-gray-600">Assess your KYC data confidence for withdrawals.</p>
                        </div>
                        <div id="action-help-withdraw" class="bg-emerald-50 p-6 rounded-lg shadow-sm text-center cursor-pointer hover:shadow-lg transition duration-300 ease-in-out transform hover:-translate-y-1">
                            <div class="text-4xl text-green-600 mb-4">üí∏</div>
                            <h3 class="text-xl font-semibold text-gray-800 mb-2">Help me Withdraw my PF</h3>
                            <p class="text-gray-600">Start a partial or full PF withdrawal claim.</p>
                        </div>
                        <div id="action-help-transfer" class="bg-teal-50 p-6 rounded-lg shadow-sm text-center cursor-pointer hover:shadow-lg transition duration-300 ease-in-out transform hover:-translate-y-1">
                            <div class="text-4xl text-teal-600 mb-4">üîÑ</div>
                            <h3 class="text-xl font-semibold text-gray-800 mb-2">Help me with PF Transfer</h3>
                            <p class="text-gray-600">Transfer your PF from previous employer.</p>
                        </div>
                        <div id="action-speak-expert" class="bg-purple-50 p-6 rounded-lg shadow-sm text-center cursor-pointer hover:shadow-lg transition duration-300 ease-in-out transform hover:-translate-y-1">
                            <div class="text-4xl text-purple-600 mb-4">üó£Ô∏è</div>
                            <h3 class="text-xl font-semibold text-gray-800 mb-2">Speak to an Expert</h3>
                            <p class="text-gray-600">Get personalized assistance from our team.</p>
                        </div>
                    </div>
                </section>

                <!-- Hero Section (Moved down) -->
                <section class="bg-white bg-opacity-90 text-center mb-12 p-6 md:p-10 rounded-xl shadow-md">
                    <h1 class="text-4xl md:text-6xl font-bold text-gray-900 mb-4 leading-tight">
                        Empowering Your Financial Future
                    </h1>
                    <p class="text-lg md:text-xl text-gray-700 mb-8 max-w-3xl mx-auto">
                        PF Saathi is dedicated to making Provident Fund management accessible and easy for everyone. Secure your savings, effortlessly.
                    </p>
                    <div class="flex flex-col sm:flex-row justify-center gap-4">
                        <a href="#" class="bg-emerald-600 hover:bg-emerald-700 text-white font-semibold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                            Get Started
                        </a>
                        <!-- This button is now redundant but kept for reference -->
                        <button id="check-pf-details-btn" class="bg-green-200 hover:bg-green-300 text-green-800 font-semibold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 hidden">
                            Check your Provident Fund Details now
                        </button>
                    </div>
                </section>

                <!-- Image Section - Village Population -->
                <section class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">
                    <div class="bg-white bg-opacity-90 p-6 rounded-xl shadow-md flex flex-col items-center text-center">
                        <img src="https://placehold.co/600x400/84cc16/ffffff?text=Happy+Village+Life" alt="Happy Indian villagers smiling and interacting, representing rural population benefiting from financial security." class="w-full h-auto rounded-lg mb-4 object-cover">
                        <h2 class="text-2xl font-semibold text-gray-800 mb-2">Reaching Every Corner</h2>
                        <p class="text-gray-600">
                            We believe financial security should be for everyone, from bustling cities to serene villages. Our services are designed to be inclusive and easy to use, empowering rural communities.
                        </p>
                    </div>

                    <!-- Image Section - Urban Poor Population -->
                    <div class="bg-white bg-opacity-90 p-6 rounded-xl shadow-md flex flex-col items-center text-center">
                        <img src="https://placehold.co/600x400/22c55e/ffffff?text=Urban+Dreams+Realized" alt="Happy urban dwellers, possibly from economically weaker sections, smiling and showing hope, representing urban poor benefiting from financial security." class="w-full h-auto rounded-lg mb-4 object-cover">
                        <h2 class="text-2xl font-semibold text-gray-800 mb-2">Empowering Urban Lives</h2>
                        <p class="text-gray-600">
                            In the heart of our cities, we strive to bring clarity and control over Provident Funds, ensuring that every urban worker can build a secure future with confidence and ease.
                        </p>
                    </div>
                </section>
            </div>

            <!-- Mobile Number Entry Section (Now used for Withdraw PF flow) -->
            <div id="mobile-input-section" class="hidden text-center bg-white bg-opacity-90 p-6 md:p-10 rounded-xl shadow-md max-w-md mx-auto">
                <h2 class="text-3xl font-bold text-gray-900 mb-6">Enter Your UAN linked Mobile Number</h2>
                <p class="text-gray-700 mb-4">Please enter your 10-digit mobile number linked with your UAN.</p>
                <input type="tel" id="mobile-number-input" placeholder="+91 XXXXXXXXXX" class="w-full p-3 border border-gray-300 rounded-lg mb-4 text-center text-lg focus:ring-emerald-500 focus:border-emerald-500" maxlength="10" pattern="[0-9]{10}">
                <button id="send-otp-btn" class="w-full bg-emerald-600 hover:bg-emerald-700 text-white font-semibold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                    Send OTP
                </button>
                <button id="back-to-home-from-mobile" class="mt-4 text-green-700 hover:text-green-900 font-medium transition duration-300 ease-in-out">
                    Back to Home
                </button>
            </div>

            <!-- OTP Entry Section (Now used for Withdraw PF flow) -->
            <div id="otp-input-section" class="hidden text-center bg-white bg-opacity-90 p-6 md:p-10 rounded-xl shadow-md max-w-md mx-auto">
                <h2 class="text-3xl font-bold text-gray-900 mb-6">Enter OTP</h2>
                <p class="text-gray-700 mb-4">An OTP has been sent to your mobile number.</p>
                <input type="text" id="otp-input" placeholder="Enter 6-digit OTP" class="w-full p-3 border border-gray-300 rounded-lg mb-4 text-center text-lg focus:ring-emerald-500 focus:border-emerald-500" maxlength="6">
                <button id="verify-otp-btn" class="w-full bg-emerald-600 hover:bg-emerald-700 text-white font-semibold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                    Verify OTP
                </button>
                <button id="back-to-mobile-from-otp" class="mt-4 text-green-700 hover:text-green-900 font-medium transition duration-300 ease-in-out">
                    Back
                </button>
            </div>

            <!-- PF Details Section (Hidden by default) -->
            <div id="pf-details-section" class="hidden bg-white bg-opacity-90 p-6 md:p-10 rounded-xl shadow-md">
                <h2 class="text-3xl md:text-4xl font-bold text-center text-gray-900 mb-8">Your Provident Fund Details</h2>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6">
                    <!-- Account Balance Tile -->
                    <div class="bg-green-50 p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-gray-800 mb-2">Account Balance</h3>
                        <p class="text-2xl font-bold text-emerald-700">‚Çπ 1,50,000.00</p>
                        <!-- Updated: Immediately Available Balance with new info icon -->
                        <p class="text-lg font-medium text-green-700 mt-2 flex items-center">
                            Immediately Available Balance: ‚Çπ 90,000.00
                            <button id="info-icon-btn" class="ml-2 text-green-600 hover:text-green-800 focus:outline-none" title="Click for calculation details">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                    <line x1="12" y1="17" x2="12.01" y2="17"></line>
                                </svg>
                            </button>
                        </p>
                        <p class="text-gray-600 text-sm mt-2">As of: 31st March 2025</p>
                    </div>

                    <!-- KYC Details Tile -->
                    <div class="bg-lime-50 p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-gray-800 mb-2 flex items-center justify-between">
                            KYC Details
                            <button id="kyc-info-btn" class="ml-2 text-green-600 hover:text-green-800 focus:outline-none" title="Click for KYC confidence details">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                    <line x1="12" y1="17" x2="12.01" y2="17"></line>
                                </svg>
                            </button>
                        </h3>
                        <ul class="list-disc list-inside text-gray-600">
                            <li>Aadhaar: Linked <span class="text-green-600">‚úì</span></li>
                            <li>PAN: Linked <span class="text-green-600">‚úì</span></li>
                            <li>Bank Account: Linked <span class="text-green-600">‚úì</span></li>
                        </ul>
                    </div>

                    <!-- Employer History Tile -->
                    <div class="bg-emerald-50 p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-gray-800 mb-2">Employer History</h3>
                        <ul class="list-disc list-inside text-gray-600">
                            <li>Tech Solutions Pvt. Ltd. (2020 - Present)</li>
                            <li>Innovate Corp. (2018 - 2020)</li>
                            <li>StartUp Hub (2016 - 2018)</li>
                        </ul>
                    </div>

                    <!-- Claims Tile (Claims removed as per request) -->
                    <div class="bg-teal-50 p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-gray-800 mb-2">Recent Claims</h3>
                        <p class="text-gray-600">No recent claims found.</p>
                    </div>
                </div>
                <div class="text-center mt-8">
                    <button id="initiate-pf-withdrawal-btn" class="bg-emerald-600 hover:bg-emerald-700 text-white font-semibold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 mb-4">
                        Initiate PF Withdrawal
                    </button>
                    <button id="back-to-home-from-pf" class="bg-green-200 hover:bg-green-300 text-green-800 font-semibold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                        Back to Home
                    </button>
                </div>
            </div>
        </main>

        <!-- Actions Section (This section is now redundant and hidden as its content is moved to landing page) -->
        <section class="container mx-auto px-4 py-8 md:py-16 hidden">
            <h2 class="text-3xl md:text-4xl font-bold text-center text-gray-900 mb-8">Actions</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Withdrawable Reasons Tile -->
                <div id="withdrawable-reasons-tile-old" class="bg-blue-50 p-6 rounded-lg shadow-md cursor-pointer hover:shadow-lg transition duration-300 ease-in-out transform hover:-translate-y-1">
                    <h3 class="text-xl font-semibold text-blue-800 mb-2">Withdrawable Reasons</h3>
                    <p class="text-gray-600">Find out the reasons for which you can withdraw your PF.</p>
                </div>
            </div>
        </section>

        <!-- Message Box -->
        <div id="message-box" class="message-box"></div>

        <!-- Info Modal for Immediately Available Balance Calculation -->
        <div id="info-modal-overlay" class="info-modal-overlay">
            <div class="info-modal-content">
                <button id="info-modal-close-btn" class="info-modal-close-btn">&times;</button>
                <h3 class="text-2xl font-bold text-gray-900 mb-4">Immediately Available Balance Calculation</h3>
                <p class="text-gray-700 text-base mb-4">
                    This is how your immediately available balance is typically calculated:
                </p>
                <div id="dynamic-balance-info" class="text-left text-lg text-gray-800 space-y-2">
                    <!-- Content will be loaded here dynamically -->
                </div>
                <p class="text-sm text-gray-500 mt-4">
                    *Note: This is a simplified explanation. Actual rules and eligibility criteria may vary. Please refer to official EPFO guidelines for precise details.*
                </p>
            </div>
        </div>

        <!-- KYC Info Modal -->
        <div id="kyc-modal-overlay" class="info-modal-overlay">
            <div class="info-modal-content">
                <button id="kyc-modal-close-btn" class="info-modal-close-btn">&times;</button>
                <h3 class="text-2xl font-bold text-gray-900 mb-4">KYC Data Confidence</h3>
                <div class="text-gray-700 mb-4">
                    <p class="mb-2">
                        <span class="font-semibold text-green-700">PAN details and Aadhaar Details Match:</span>
                        <span class="text-lg font-bold text-emerald-600">High Match</span>
                        <br>
                        <span class="text-sm text-gray-600">Less chances of rejections due to this reason.</span>
                    </p>
                    <p class="mb-2">
                        <span class="font-semibold text-green-700">PAN and UAN details:</span>
                        <span class="text-lg font-bold text-emerald-600">High Match</span>
                        <br>
                        <span class="text-sm text-gray-600">Less chances of rejections due to this reason.</span>
                    </p>
                    <div class="mt-4 p-3 bg-green-100 rounded-lg text-center">
                        <p class="text-xl font-bold text-green-800">
                            Cumulative Score: High Confidence
                        </p>
                        <p class="text-sm text-gray-700">
                            This indicates a low chance of rejections during withdrawal due to data discrepancies.
                        </p>
                    </div>
                </div>
                <p class="text-sm text-gray-500">
                    *Note: This confidence score is for informational purposes and based on data matching. Final approval depends on official EPFO verification processes.*
                </p>
            </div>
        </div>

        <!-- Withdrawable Reasons Modal -->
        <div id="reasons-modal-overlay" class="info-modal-overlay">
            <div class="info-modal-content">
                <button id="reasons-modal-close-btn" class="info-modal-close-btn">&times;</button>
                <h3 class="text-2xl font-bold text-gray-900 mb-4">Reasons for PF Withdrawal</h3>
                <ul id="reasons-list" class="list-none text-left space-y-2 text-gray-700">
                    <li class="p-2 rounded-md hover:bg-green-50 cursor-pointer transition duration-150 ease-in-out" data-reason="Medical Purposes">Medical Purposes</li>
                    <li class="p-2 rounded-md hover:bg-green-50 cursor-pointer transition duration-150 ease-in-out" data-reason="Marriage">Marriage (Self, Child, Sibling)</li>
                    <li class="p-2 rounded-md hover:bg-green-50 cursor-pointer transition duration-150 ease-in-out" data-reason="Education">Education (Self, Child)</li>
                    <li class="p-2 rounded-md hover:bg-green-50 cursor-pointer transition duration-150 ease-in-out" data-reason="House Purchase/Construction">House Purchase/Construction</li>
                    <li class="p-2 rounded-md hover:bg-green-50 cursor-pointer transition duration-150 ease-in-out" data-reason="House Renovation/Alteration">House Renovation/Alteration</li>
                    <li class="p-2 rounded-md hover:bg-green-50 cursor-pointer transition duration-150 ease-in-out" data-reason="Repayment of Home Loan">Repayment of Home Loan</li>
                    <li class="p-2 rounded-md hover:bg-green-50 cursor-pointer transition duration-150 ease-in-out" data-reason="Unemployment">Unemployment (1 month / 2 months)</li>
                    <li class="p-2 rounded-md hover:bg-green-50 cursor-pointer transition duration-150 ease-in-out" data-reason="One year before Retirement">One year before Retirement (age 54+)</li>
                    <li class="p-2 rounded-md hover:bg-green-50 cursor-pointer transition duration-150 ease-in-out" data-reason="Disability">Disability</li>
                </ul>
            </div>
        </div>

        <!-- Marriage Withdrawal Eligibility Section -->
        <div id="marriage-withdrawal-eligibility-section" class="hidden text-center bg-white bg-opacity-90 p-6 md:p-10 rounded-xl shadow-md max-w-md mx-auto">
            <h2 class="text-3xl font-bold text-gray-900 mb-6">Marriage Withdrawal: Check Eligibility</h2>
            <p class="text-gray-700 mb-4">
                To withdraw for marriage, you must have completed at least 7 years of EPF membership. You can withdraw up to 50% of your employee's share + interest.
            </p>
            <div class="mb-4">
                <label for="years-of-service" class="block text-left text-gray-700 text-sm font-bold mb-2">Years of EPF Service:</label>
                <input type="number" id="years-of-service" value="8" class="w-full p-3 border border-gray-300 rounded-lg text-center text-lg focus:ring-emerald-500 focus:border-emerald-500">
            </div>
            <div class="mb-6">
                <label for="employee-share-balance" class="block text-left text-gray-700 text-sm font-bold mb-2">Employee Share + Interest (‚Çπ):</label>
                <input type="number" id="employee-share-balance" value="180000" class="w-full p-3 border border-gray-300 rounded-lg text-center text-lg focus:ring-emerald-500 focus:border-emerald-500">
            </div>
            <div id="eligible-amount-display" class="text-lg font-semibold text-emerald-700 mb-4"></div>
            <button id="check-eligibility-btn" class="w-full bg-emerald-600 hover:bg-emerald-700 text-white font-semibold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 mb-4">
                Check Eligibility & Calculate Amount
            </button>

            <!-- New: Desired Withdrawal Amount Input -->
            <div id="desired-withdrawal-input-group" class="mb-6 hidden">
                <label for="desired-withdrawal-amount" class="block text-left text-gray-700 text-sm font-bold mb-2">Enter Desired Withdrawal Amount (‚Çπ):</label>
                <input type="number" id="desired-withdrawal-amount" placeholder="e.g., 50000" class="w-full p-3 border border-gray-300 rounded-lg text-center text-lg focus:ring-emerald-500 focus:border-emerald-500">
            </div>

            <button id="get-withdrawal-advice-btn" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 mb-4 hidden">
                ‚ú® Get Personalized Withdrawal Advice
            </button>
            <button id="proceed-to-bank-details-btn" class="w-full bg-green-200 hover:bg-green-300 text-green-800 font-semibold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 hidden">
                Proceed to Bank Details
            </button>
            <button id="back-to-pf-details-from-eligibility" class="mt-4 text-green-700 hover:text-green-900 font-medium transition duration-300 ease-in-out">
                Back to PF Details
            </button>
        </div>

        <!-- Bank Details Confirmation Section -->
        <div id="bank-details-confirmation-section" class="hidden text-center bg-white bg-opacity-90 p-6 md:p-10 rounded-xl shadow-md max-w-md mx-auto">
            <h2 class="text-3xl font-bold text-gray-900 mb-6">Confirm Bank Details</h2>
            <p class="text-gray-700 mb-4">Please confirm your linked bank account details.</p>
            <div class="bg-green-50 p-4 rounded-lg mb-4 text-left">
                <p class="font-semibold text-gray-800">Linked Bank Account:</p>
                <p class="text-lg text-emerald-700">XXXX XXXX 1234</p>
                <p class="text-sm text-gray-600">Dummy Bank Name, Dummy Branch</p>
            </div>
            <div class="mb-6">
                <label for="last-4-digits-input" class="block text-left text-gray-700 text-sm font-bold mb-2">Enter Last 4 Digits of Bank Account:</label>
                <input type="text" id="last-4-digits-input" placeholder="e.g., 1234" maxlength="4" class="w-full p-3 border border-gray-300 rounded-lg text-center text-lg focus:ring-emerald-500 focus:border-emerald-500">
            </div>
            <button id="verify-bank-details-btn" class="w-full bg-emerald-600 hover:bg-emerald-700 text-white font-semibold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 mb-4">
                Verify Bank Account & Proceed
            </button>
            <button id="back-to-eligibility-from-bank" class="mt-4 text-green-700 hover:text-green-900 font-medium transition duration-300 ease-in-out">
                Back
            </button>
        </div>

        <!-- Address Confirmation Section -->
        <div id="address-confirmation-section" class="hidden text-center bg-white bg-opacity-90 p-6 md:p-10 rounded-xl shadow-md max-w-md mx-auto">
            <h2 class="text-3xl font-bold text-gray-900 mb-6">Confirm Address</h2>
            <p class="text-gray-700 mb-4">Please confirm your registered address.</p>
            <div class="bg-green-50 p-4 rounded-lg mb-4 text-left">
                <p class="font-semibold text-gray-800">Registered Address:</p>
                <p class="text-lg text-emerald-700">Flat 101, Green Apartments, Cyber City, Bengaluru, Karnataka - 560001</p>
            </div>
            <div class="mb-6 flex items-center justify-center">
                <input type="checkbox" id="address-correct-checkbox" class="h-5 w-5 text-emerald-600 rounded focus:ring-emerald-500">
                <label for="address-correct-checkbox" class="ml-2 text-gray-700">Is this address correct?</label>
            </div>
            <button id="confirm-address-btn" class="w-full bg-emerald-600 hover:bg-emerald-700 text-white font-semibold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 mb-4" disabled>
                Confirm Address & Proceed
            </button>
            <button id="back-to-bank-from-address" class="mt-4 text-green-700 hover:text-green-900 font-medium transition duration-300 ease-in-out">
                Back
            </button>
        </div>

        <!-- Review and Submit Section -->
        <div id="review-and-submit-section" class="hidden bg-white bg-opacity-90 p-6 md:p-10 rounded-xl shadow-md max-w-lg mx-auto">
            <h2 class="text-3xl font-bold text-center text-gray-900 mb-6">Review Your Claim</h2>
            <div class="space-y-4 text-left mb-6">
                <div class="p-4 bg-green-50 rounded-lg">
                    <p class="font-semibold text-gray-800">Withdrawal Reason:</p>
                    <p class="text-lg text-emerald-700">Marriage</p>
                </div>
                <div class="p-4 bg-lime-50 rounded-lg">
                    <p class="font-semibold text-gray-800">Requested Withdrawal Amount:</p>
                    <p class="text-lg text-emerald-700" id="review-withdrawal-amount">‚Çπ 0.00</p>
                </div>
                <div class="p-4 bg-emerald-50 rounded-lg">
                    <p class="font-semibold text-gray-800">Confirmed Bank Account:</p>
                    <p class="text-lg text-emerald-700">XXXX XXXX <span id="review-bank-digits"></span></p>
                </div>
                <div class="p-4 bg-teal-50 rounded-lg">
                    <p class="font-semibold text-gray-800">Confirmed Address:</p>
                    <p class="text-lg text-emerald-700" id="review-address">Flat 101, Green Apartments, Cyber City, Bengaluru, Karnataka - 560001</p>
                </div>
            </div>
            <div class="mb-6 flex items-center justify-center">
                <input type="checkbox" id="terms-checkbox" class="h-5 w-5 text-emerald-600 rounded focus:ring-emerald-500">
                <label for="terms-checkbox" class="ml-2 text-gray-700">I agree to the <a href="#" class="text-blue-600 hover:underline">terms and conditions</a>.</label>
            </div>
            <button id="submit-claim-btn" class="w-full bg-emerald-600 hover:bg-emerald-700 text-white font-semibold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 mb-4" disabled>
                Submit PF Withdrawal Claim
            </button>
            <button id="back-to-address-from-review" class="mt-4 text-green-700 hover:text-green-900 font-medium transition duration-300 ease-in-out">
                Back
            </button>
        </div>

        <!-- Claim Submission Success Section -->
        <div id="claim-submission-success-section" class="hidden text-center bg-white bg-opacity-90 p-6 md:p-10 rounded-xl shadow-md max-w-md mx-auto">
            <h2 class="text-3xl font-bold text-gray-900 mb-6">Claim Submitted Successfully!</h2>
            <p class="text-gray-700 mb-4">
                Your PF withdrawal claim for Marriage has been submitted.
            </p>
            <p class="text-xl font-bold text-emerald-700 mb-6">
                Acknowledgment Number: <span id="acknowledgment-number">PFSAATHI2025XXXXX</span>
            </p>
            <p class="text-gray-600 text-sm">
                Funds will be credited to your linked bank account within 3-5 business days.
            </p>
            <button id="back-to-home-from-success" class="mt-8 bg-green-200 hover:bg-green-300 text-green-800 font-semibold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                Back to Home
            </button>
        </div>

        <!-- Withdrawal Advice Modal (New LLM Feature) -->
        <div id="withdrawal-advice-modal-overlay" class="info-modal-overlay">
            <div class="info-modal-content">
                <button id="withdrawal-advice-modal-close-btn" class="info-modal-close-btn">&times;</button>
                <h3 class="text-2xl font-bold text-gray-900 mb-4">‚ú® Personalized Withdrawal Advice</h3>
                <div id="withdrawal-advice-content" class="text-gray-700 mb-4">
                    <div class="flex justify-center items-center h-32">
                        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"></div>
                        <p class="ml-4 text-gray-700">Generating advice...</p>
                    </div>
                </div>
                <p class="text-sm text-gray-500">
                    *Advice generated by AI. Please cross-verify with official EPFO guidelines.*
                </p>
            </div>
        </div>

        <!-- PF Data Score Section (New) -->
        <div id="pf-data-score-section" class="hidden bg-white bg-opacity-90 p-6 md:p-10 rounded-xl shadow-md max-w-lg mx-auto">
            <h2 class="text-3xl md:text-4xl font-bold text-center text-gray-900 mb-8">Your PF Data Score</h2>

            <div class="space-y-6 text-left mb-8">
                <div class="p-4 bg-blue-50 rounded-lg shadow-sm">
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">Data Completeness Score</h3>
                    <p class="text-2xl font-bold text-blue-700">High</p>
                    <p class="text-gray-600 text-sm mt-1">All essential data fields are populated.</p>
                </div>

                <div class="p-4 bg-red-50 rounded-lg shadow-sm">
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">Data Match Score</h3>
                    <p class="text-2xl font-bold text-red-700">Low</p>
                    <p class="text-gray-600 text-sm mt-1">Discrepancies found between linked documents (e.g., PAN, Aadhaar, UAN).</p>
                </div>

                <div class="p-4 bg-yellow-50 rounded-lg shadow-md text-center">
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">Overall Data Impact Score</h3>
                    <p class="text-3xl font-bold text-red-700 blinking-text">75% Chances of Rejection during Withdrawal</p>
                    <p class="text-gray-600 text-sm mt-2">Action required to rectify data mismatches to ensure smooth withdrawals.</p>
                    <button id="fix-data-now-btn" class="mt-4 bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-6 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                        Fix Data Now
                    </button>
                </div>
            </div>

            <div class="text-center mt-8">
                <button id="back-to-home-from-data-score" class="bg-green-200 hover:bg-green-300 text-green-800 font-semibold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                    Back to Home
                </button>
            </div>
        </div>

        <!-- Data Mismatch Fix Section (New) -->
        <div id="data-mismatch-fix-section" class="hidden text-center bg-white bg-opacity-90 p-6 md:p-10 rounded-xl shadow-md max-w-md mx-auto">
            <h2 class="text-3xl font-bold text-gray-900 mb-6">Fix Data Mismatch</h2>
            <p class="text-gray-700 mb-4">We've detected a slight mismatch in your father's name:</p>

            <div class="bg-red-50 p-4 rounded-lg mb-6 text-left">
                <p class="font-semibold text-gray-800">Father's Name in PAN:</p>
                <p class="text-lg text-red-700">Ram Kumar</p>
                <p class="font-semibold text-gray-800 mt-3">Father's Name in UAN:</p>
                <p class="text-lg text-red-700">Ram Kumaar</p>
            </div>

            <p class="text-gray-700 mb-4">Please update your PAN data to ensure consistency.</p>

            <div class="mb-4">
                <label for="pan-number-input" class="block text-left text-gray-700 text-sm font-bold mb-2">Your PAN Number:</label>
                <input type="text" id="pan-number-input" value="ABCDE1234F" class="w-full p-3 border border-gray-300 rounded-lg text-center text-lg bg-gray-100" readonly>
            </div>
            <div class="mb-6">
                <label for="corrected-father-name-input" class="block text-left text-gray-700 text-sm font-bold mb-2">Corrected Father's Name (as per official records):</label>
                <input type="text" id="corrected-father-name-input" placeholder="e.g., Ram Kumar" class="w-full p-3 border border-gray-300 rounded-lg text-center text-lg focus:ring-emerald-500 focus:border-emerald-500">
            </div>

            <button id="submit-pan-update-btn" class="w-full bg-emerald-600 hover:bg-emerald-700 text-white font-semibold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 mb-4">
                Submit PAN Update Request
            </button>
            <button id="back-to-data-score-from-fix" class="mt-4 text-green-700 hover:text-green-900 font-medium transition duration-300 ease-in-out">
                Back to Data Score
            </button>
        </div>

        <!-- PAN Update Success Section (New) -->
        <div id="pan-update-success-section" class="hidden text-center bg-white bg-opacity-90 p-6 md:p-10 rounded-xl shadow-md max-w-md mx-auto">
            <h2 class="text-3xl font-bold text-gray-900 mb-6">PAN Update Request Submitted!</h2>
            <p class="text-gray-700 mb-4">
                Your request to update father's name on PAN has been submitted.
            </p>
            <p class="text-gray-600 text-sm mb-6">
                You will be notified about the update from PAN directly. You can also check the status in the "Track Requests" section of PF Saathi.
            </p>
            <button id="back-to-home-from-pan-success" class="mt-8 bg-green-200 hover:bg-green-300 text-green-800 font-semibold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                Back to Home
            </button>
        </div>

        <!-- Balance Only Section (New) -->
        <div id="balance-only-section" class="hidden text-center bg-white bg-opacity-90 p-6 md:p-10 rounded-xl shadow-md max-w-md mx-auto">
            <h2 class="text-3xl font-bold text-gray-900 mb-6">Your PF Balance</h2>
            <div class="bg-green-50 p-6 rounded-lg shadow-sm mb-4">
                <h3 class="text-xl font-semibold text-gray-800 mb-2">Account Balance</h3>
                <p class="text-2xl font-bold text-emerald-700">‚Çπ 1,50,000.00</p>
                <p class="text-lg font-medium text-green-700 mt-2 flex items-center justify-center">
                    Immediately Available Balance: ‚Çπ 90,000.00
                    <button id="info-icon-btn-balance-only" class="ml-2 text-green-600 hover:text-green-800 focus:outline-none" title="Click for calculation details">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                            <line x1="12" y1="17" x2="12.01" y2="17"></line>
                        </svg>
                    </button>
                </p>
                <p class="text-gray-600 text-sm mt-2">As of: 31st March 2025</p>
            </div>
            <button id="back-to-home-from-balance-only" class="bg-green-200 hover:bg-green-300 text-green-800 font-semibold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                Back to Home
            </button>
        </div>


        <!-- Footer Section -->
        <footer class="bg-green-900 text-white py-6 px-4 md:px-12 mt-8 rounded-t-xl">
            <div class="container mx-auto text-center text-sm md:text-base">
                <p>&copy; 2025 PF Saathi. All rights reserved.</p>
                <p class="mt-2">
                    Contact Us: <a href="mailto:info@pfsaathi.com" class="text-lime-400 hover:underline">info@pfsaathi.com</a>
                </p>
            </div>
        </footer>
    </div>

    <script>
        // Get references to main sections
        const landingPageContent = document.getElementById('landing-page-content');
        const mobileInputSection = document.getElementById('mobile-input-section');
        const otpInputSection = document.getElementById('otp-input-section');
        const pfDetailsSection = document.getElementById('pf-details-section');
        const marriageWithdrawalEligibilitySection = document.getElementById('marriage-withdrawal-eligibility-section');
        const bankDetailsConfirmationSection = document.getElementById('bank-details-confirmation-section');
        const addressConfirmationSection = document.getElementById('address-confirmation-section');
        const reviewAndSubmitSection = document.getElementById('review-and-submit-section');
        const claimSubmissionSuccessSection = document.getElementById('claim-submission-success-section');
        const pfDataScoreSection = document.getElementById('pf-data-score-section');
        const dataMismatchFixSection = document.getElementById('data-mismatch-fix-section');
        const panUpdateSuccessSection = document.getElementById('pan-update-success-section');
        const balanceOnlySection = document.getElementById('balance-only-section');

        const messageBox = document.getElementById('message-box');
        const infoModalOverlay = document.getElementById('info-modal-overlay');
        const kycModalOverlay = document.getElementById('kyc-modal-overlay');
        const reasonsModalOverlay = document.getElementById('reasons-modal-overlay');
        const withdrawalAdviceModalOverlay = document.getElementById('withdrawal-advice-modal-overlay');

        // Get references to buttons and inputs
        const backToHomeFromPfBtn = document.getElementById('back-to-home-from-pf');
        const infoIconBtn = document.getElementById('info-icon-btn');
        const infoModalCloseBtn = document.getElementById('info-modal-close-btn');
        const kycInfoBtn = document.getElementById('kyc-info-btn');
        const kycModalCloseBtn = document.getElementById('kyc-modal-close-btn');
        const reasonsModalCloseBtn = document.getElementById('reasons-modal-close-btn');
        const reasonsList = document.getElementById('reasons-list');

        // Main action tiles
        const actionCheckBalance = document.getElementById('action-check-balance');
        const actionCheckDataScore = document.getElementById('action-check-data-score');
        const actionHelpWithdraw = document.getElementById('action-help-withdraw');
        const actionHelpTransfer = document.getElementById('action-help-transfer');
        const actionSpeakExpert = document.getElementById('action-speak-expert');

        // Mobile/OTP related elements
        const mobileNumberInput = document.getElementById('mobile-number-input');
        const sendOtpBtn = document.getElementById('send-otp-btn');
        const otpInput = document.getElementById('otp-input');
        const verifyOtpBtn = document.getElementById('verify-otp-btn');
        const backToHomeFromMobileBtn = document.getElementById('back-to-home-from-mobile');
        const backToMobileFromOtpBtn = document.getElementById('back-to-mobile-from-otp');

        // Button in PF Details Section
        const initiatePfWithdrawalBtn = document.getElementById('initiate-pf-withdrawal-btn');

        // Elements for withdrawal workflow
        const yearsOfServiceInput = document.getElementById('years-of-service');
        const employeeShareBalanceInput = document.getElementById('employee-share-balance');
        const eligibleAmountDisplay = document.getElementById('eligible-amount-display');
        const checkEligibilityBtn = document.getElementById('check-eligibility-btn');
        const desiredWithdrawalAmountInput = document.getElementById('desired-withdrawal-amount');
        const desiredWithdrawalInputGroup = document.getElementById('desired-withdrawal-input-group');
        const getWithdrawalAdviceBtn = document.getElementById('get-withdrawal-advice-btn');
        const proceedToBankDetailsBtn = document.getElementById('proceed-to-bank-details-btn');
        const backToPfDetailsFromEligibilityBtn = document.getElementById('back-to-pf-details-from-eligibility');

        const last4DigitsInput = document.getElementById('last-4-digits-input');
        const verifyBankDetailsBtn = document.getElementById('verify-bank-details-btn');
        const backToEligibilityFromBankBtn = document.getElementById('back-to-eligibility-from-bank');

        const addressCorrectCheckbox = document.getElementById('address-correct-checkbox');
        const confirmAddressBtn = document.getElementById('confirm-address-btn');
        const backToBankFromAddressBtn = document.getElementById('back-to-bank-from-address');

        const reviewWithdrawalAmount = document.getElementById('review-withdrawal-amount');
        const reviewBankDigits = document.getElementById('review-bank-digits');
        const reviewAddress = document.getElementById('review-address');
        const termsCheckbox = document.getElementById('terms-checkbox');
        const submitClaimBtn = document.getElementById('submit-claim-btn');
        const backToAddressFromReviewBtn = document.getElementById('back-to-address-from-review');

        const acknowledgmentNumberSpan = document.getElementById('acknowledgment-number');
        const backToHomeFromSuccessBtn = document.getElementById('back-to-home-from-success');
        const backToHomeFromDataScoreBtn = document.getElementById('back-to-home-from-data-score');

        const withdrawalAdviceContent = document.getElementById('withdrawal-advice-content');
        const withdrawalAdviceModalCloseBtn = document.getElementById('withdrawal-advice-modal-close-btn');

        // Elements for data mismatch fix workflow
        const fixDataNowBtn = document.getElementById('fix-data-now-btn');
        const panNumberInput = document.getElementById('pan-number-input');
        const correctedFatherNameInput = document.getElementById('corrected-father-name-input');
        const submitPanUpdateBtn = document.getElementById('submit-pan-update-btn');
        const backToDataScoreFromFixBtn = document.getElementById('back-to-data-score-from-fix');
        const backToHomeFromPanSuccessBtn = document.getElementById('back-to-home-from-pan-success');

        // Elements for balance-only section
        const infoIconBtnBalanceOnly = document.getElementById('info-icon-btn-balance-only');
        const backToHomeFromBalanceOnlyBtn = document.getElementById('back-to-home-from-balance-only');
        const dynamicBalanceInfo = document.getElementById('dynamic-balance-info');


        let calculatedEligibleWithdrawalAmount = 0;
        let currentYearsOfService = 0;
        let currentEmployeeShareBalance = 0;
        let finalRequestedWithdrawalAmount = 0;

        // Content for dynamic balance info display
        const balanceInfoSentences = [
            "Upon Retirement or Superannuation: You can withdraw your full balance.",
            "For Unemployment (after 1 month): Up to 75% of your PF balance can be withdrawn.",
            "For Unemployment (after 2 months): The remaining 25% of your PF balance becomes available.",
            "For Specific Purposes (e.g., house purchase, medical needs): Partial withdrawals are allowed under certain conditions, usually a percentage of your contribution or a fixed amount, whichever is less."
        ];

        // Function to show a message
        function showMessage(message, isError = false) {
            messageBox.textContent = message;
            messageBox.classList.remove('error');
            if (isError) {
                messageBox.classList.add('error');
            }
            messageBox.classList.add('show');
            setTimeout(() => {
                messageBox.classList.remove('show');
            }, 3000); // Hide after 3 seconds
        }

        // Function to hide all content sections and show a specific one
        function showSection(sectionToShow) {
            landingPageContent.classList.add('hidden');
            mobileInputSection.classList.add('hidden');
            otpInputSection.classList.add('hidden');
            pfDetailsSection.classList.add('hidden');
            marriageWithdrawalEligibilitySection.classList.add('hidden');
            bankDetailsConfirmationSection.classList.add('hidden');
            addressConfirmationSection.classList.add('hidden');
            reviewAndSubmitSection.classList.add('hidden');
            claimSubmissionSuccessSection.classList.add('hidden');
            pfDataScoreSection.classList.add('hidden');
            dataMismatchFixSection.classList.add('hidden');
            panUpdateSuccessSection.classList.add('hidden');
            balanceOnlySection.classList.add('hidden');

            // Ensure modals are hidden when switching main sections
            infoModalOverlay.classList.remove('show');
            kycModalOverlay.classList.remove('show');
            reasonsModalOverlay.classList.remove('show');
            withdrawalAdviceModalOverlay.classList.remove('show');

            sectionToShow.classList.remove('hidden');
        }

        // Function to display balance info dynamically
        function displayBalanceInfoDynamically() {
            dynamicBalanceInfo.innerHTML = ''; // Clear previous content
            let delay = 0;
            balanceInfoSentences.forEach((sentence, index) => {
                setTimeout(() => {
                    const p = document.createElement('p');
                    p.textContent = sentence;
                    p.classList.add('opacity-0', 'transition-opacity', 'duration-500', 'ease-in-out'); // Add classes for fade-in
                    dynamicBalanceInfo.appendChild(p);
                    // Trigger reflow to apply initial opacity before setting to 1
                    p.offsetHeight;
                    p.classList.remove('opacity-0');
                }, delay);
                delay += 1000; // 1 second delay between sentences
            });
        }

        // --- Action Tile Event Listeners ---
        actionCheckBalance.addEventListener('click', () => {
            showSection(balanceOnlySection); // Show only the balance section
        });

        actionCheckDataScore.addEventListener('click', () => {
            showSection(pfDataScoreSection);
        });

        actionHelpWithdraw.addEventListener('click', () => {
            showSection(mobileInputSection);
            mobileNumberInput.value = ''; // Clear input
        });

        actionHelpTransfer.addEventListener('click', () => {
            showMessage('PF Transfer functionality coming soon!', false);
        });

        actionSpeakExpert.addEventListener('click', () => {
            showMessage('Connecting you to an expert... (This is a placeholder)', false);
        });
        // --- End Action Tile Event Listeners ---

        // --- Mobile/OTP Workflow ---
        sendOtpBtn.addEventListener('click', () => {
            const mobileNumber = mobileNumberInput.value;
            if (!/^\d{10}$/.test(mobileNumber)) {
                showMessage('Please enter a valid 10-digit mobile number.', true);
                return;
            }
            showMessage(`OTP sent to +91 ${mobileNumber}.`);
            showSection(otpInputSection);
            otpInput.value = ''; // Clear OTP input
        });

        verifyOtpBtn.addEventListener('click', () => {
            const otp = otpInput.value;
            if (otp.length !== 6 || !/^\d{6}$/.test(otp)) {
                showMessage('Please enter a valid 6-digit OTP.', true);
                return;
            }
            showMessage('OTP Verified Successfully!');
            showSection(pfDetailsSection); // Proceed to PF Details after successful OTP
        });

        backToHomeFromMobileBtn.addEventListener('click', () => {
            showSection(landingPageContent);
            mobileNumberInput.value = '';
        });

        backToMobileFromOtpBtn.addEventListener('click', () => {
            showSection(mobileInputSection);
            otpInput.value = '';
        });
        // --- End Mobile/OTP Workflow ---


        // Initiate PF Withdrawal button in PF Details section
        initiatePfWithdrawalBtn.addEventListener('click', () => {
            reasonsModalOverlay.classList.add('show'); // Show the withdrawal reasons modal
        });


        // Event listener for "Back to Home" button from PF details section
        backToHomeFromPfBtn.addEventListener('click', () => {
            showSection(landingPageContent);
        });

        // Event listener for Immediately Available Balance info icon button (in full PF Details)
        infoIconBtn.addEventListener('click', () => {
            displayBalanceInfoDynamically(); // Call dynamic display
            infoModalOverlay.classList.add('show');
        });

        // Event listener for Immediately Available Balance info icon button (in balance-only section)
        infoIconBtnBalanceOnly.addEventListener('click', () => {
            displayBalanceInfoDynamically(); // Call dynamic display
            infoModalOverlay.classList.add('show');
        });


        // Event listener for Immediately Available Balance info modal close button
        infoModalCloseBtn.addEventListener('click', () => {
            infoModalOverlay.classList.remove('show');
        });

        // Close Immediately Available Balance modal if clicked outside (on overlay)
        infoModalOverlay.addEventListener('click', (event) => {
            if (event.target === infoModalOverlay) {
                infoModalOverlay.classList.remove('show');
            }
        });

        // Event listener for KYC info icon button
        kycInfoBtn.addEventListener('click', () => {
            kycModalOverlay.classList.add('show');
        });

        // Event listener for KYC info modal close button
        kycModalCloseBtn.addEventListener('click', () => {
            kycModalOverlay.classList.remove('show');
        });

        // Close KYC modal if clicked outside (on overlay)
        kycModalOverlay.addEventListener('click', (event) => {
            if (event.target === kycModalOverlay) {
                kycModalOverlay.classList.remove('show');
            }
        });

        // Event listener for Withdrawable Reasons modal close button
        reasonsModalCloseBtn.addEventListener('click', () => {
            reasonsModalOverlay.classList.remove('show');
        });

        // Close Withdrawable Reasons modal if clicked outside (on overlay)
        reasonsModalOverlay.addEventListener('click', (event) => {
            if (event.target === reasonsModalOverlay) {
                reasonsModalOverlay.classList.remove('show');
            }
        });

        // Event listener for clicking a reason in the list
        reasonsList.addEventListener('click', (event) => {
            if (event.target.tagName === 'LI') {
                const selectedReason = event.target.dataset.reason;
                showMessage(`Selected Reason: ${selectedReason}`);
                reasonsModalOverlay.classList.remove('show');

                // If 'Marriage' is selected, proceed to the eligibility section
                if (selectedReason === 'Marriage') {
                    showSection(marriageWithdrawalEligibilitySection);
                    // Reset eligibility section inputs and hide dependent elements
                    yearsOfServiceInput.value = '8'; // Pre-fill
                    employeeShareBalanceInput.value = '180000'; // Pre-fill (50% of 180000 is 90000)
                    eligibleAmountDisplay.textContent = '';
                    desiredWithdrawalAmountInput.value = ''; // Clear desired amount
                    desiredWithdrawalInputGroup.classList.add('hidden'); // Hide desired amount input
                    proceedToBankDetailsBtn.classList.add('hidden');
                    getWithdrawalAdviceBtn.classList.add('hidden'); // Hide advice button initially
                } else {
                    // For other reasons, just show a message for now
                    showMessage(`Functionality for '${selectedReason}' withdrawal is coming soon!`, false);
                    showSection(pfDetailsSection); // Go back to PF details section after message
                }
            }
        });

        // Marriage Withdrawal Eligibility Logic
        checkEligibilityBtn.addEventListener('click', () => {
            const years = parseInt(yearsOfServiceInput.value);
            const balance = parseFloat(employeeShareBalanceInput.value);

            currentYearsOfService = years; // Store for LLM call
            currentEmployeeShareBalance = balance; // Store for LLM call

            if (isNaN(years) || isNaN(balance) || years < 0 || balance < 0) {
                showMessage('Please enter valid numbers for years of service and balance.', true);
                eligibleAmountDisplay.textContent = '';
                desiredWithdrawalInputGroup.classList.add('hidden');
                proceedToBankDetailsBtn.classList.add('hidden');
                getWithdrawalAdviceBtn.classList.add('hidden');
                return;
            }

            if (years >= 7) {
                calculatedEligibleWithdrawalAmount = balance * 0.50; // 50% of employee's share + interest
                eligibleAmountDisplay.textContent = `Maximum Eligible Withdrawal: ‚Çπ ${calculatedEligibleWithdrawalAmount.toLocaleString('en-IN', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                eligibleAmountDisplay.classList.remove('text-red-600');
                eligibleAmountDisplay.classList.add('text-emerald-700');

                desiredWithdrawalInputGroup.classList.remove('hidden'); // Show desired amount input
                desiredWithdrawalAmountInput.value = ''; // Clear previous value
                proceedToBankDetailsBtn.classList.add('hidden'); // Disable until valid amount entered
                getWithdrawalAdviceBtn.classList.remove('hidden'); // Show advice button
                showMessage('You are eligible for Marriage Withdrawal! Enter your desired amount.');
            } else {
                eligibleAmountDisplay.textContent = `Not Eligible: Requires at least 7 years of service.`;
                eligibleAmountDisplay.classList.remove('text-emerald-700');
                eligibleAmountDisplay.classList.add('text-red-600');
                desiredWithdrawalInputGroup.classList.add('hidden'); // Hide desired amount input
                proceedToBankDetailsBtn.classList.add('hidden');
                getWithdrawalAdviceBtn.classList.add('hidden'); // Hide advice button
                showMessage('You are not eligible for Marriage Withdrawal yet.', true);
            }
        });

        // Event listener for desired withdrawal amount input
        desiredWithdrawalAmountInput.addEventListener('input', () => {
            const desiredAmount = parseFloat(desiredWithdrawalAmountInput.value);

            if (isNaN(desiredAmount) || desiredAmount <= 0) {
                showMessage('Please enter a valid positive amount for withdrawal.', true);
                proceedToBankDetailsBtn.classList.add('hidden');
                return;
            }

            if (desiredAmount > calculatedEligibleWithdrawalAmount) {
                showMessage(`Desired amount (‚Çπ${desiredAmount.toLocaleString('en-IN')}) exceeds eligible amount (‚Çπ${calculatedEligibleWithdrawalAmount.toLocaleString('en-IN')}).`, true);
                proceedToBankDetailsBtn.classList.add('hidden');
            } else {
                showMessage('Amount entered is valid.');
                finalRequestedWithdrawalAmount = desiredAmount; // Store the valid amount
                proceedToBankDetailsBtn.classList.remove('hidden');
            }
        });


        // LLM Integration: Get Personalized Withdrawal Advice
        getWithdrawalAdviceBtn.addEventListener('click', async () => {
            withdrawalAdviceModalOverlay.classList.add('show');
            withdrawalAdviceContent.innerHTML = `
                <div class="flex justify-center items-center h-32">
                    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"></div>
                    <p class="ml-4 text-gray-700">Generating advice...</p>
                </div>
            `; // Show loading spinner

            const prompt = `You are a helpful assistant providing guidance on Provident Fund (PF) withdrawals in India. A user is considering a partial PF withdrawal for 'Marriage'. They have ${currentYearsOfService} years of EPF service and are eligible to withdraw ‚Çπ ${calculatedEligibleWithdrawalAmount.toLocaleString('en-IN', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}. Provide concise, helpful advice on what documents they might need, any common pitfalls to avoid for this specific reason, and general best practices for PF withdrawals for marriage. Keep it under 200 words.`;

            let chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
            const payload = { contents: chatHistory };
            const apiKey = ""; // If you want to use models other than gemini-2.0-flash or imagen-3.0-generate-002, provide an API key here. Otherwise, leave this as-is.
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    withdrawalAdviceContent.innerHTML = `<p>${text}</p>`;
                } else {
                    withdrawalAdviceContent.innerHTML = `<p class="text-red-600">Failed to generate advice. Please try again.</p>`;
                    console.error('LLM response structure unexpected:', result);
                }
            } catch (error) {
                withdrawalAdviceContent.innerHTML = `<p class="text-red-600">Error connecting to AI. Please check your network or try again later.</p>`;
                console.error('Error calling Gemini API:', error);
            }
        });

        withdrawalAdviceModalCloseBtn.addEventListener('click', () => {
            withdrawalAdviceModalOverlay.classList.remove('show');
        });

        withdrawalAdviceModalOverlay.addEventListener('click', (event) => {
            if (event.target === withdrawalAdviceModalOverlay) {
                withdrawalAdviceModalOverlay.classList.remove('show');
            }
        });


        proceedToBankDetailsBtn.addEventListener('click', () => {
            // Ensure the finalRequestedWithdrawalAmount is set before proceeding
            if (finalRequestedWithdrawalAmount <= 0 || finalRequestedWithdrawalAmount > calculatedEligibleWithdrawalAmount) {
                showMessage('Please enter a valid withdrawal amount to proceed.', true);
                return;
            }
            showSection(bankDetailsConfirmationSection);
            last4DigitsInput.value = ''; // Clear input
        });

        backToPfDetailsFromEligibilityBtn.addEventListener('click', () => {
            showSection(pfDetailsSection); // Go back to PF details section
        });

        // Bank Details Confirmation Logic
        verifyBankDetailsBtn.addEventListener('click', () => {
            const last4 = last4DigitsInput.value;
            if (last4 === '1234') { // Dummy verification
                showMessage('Bank Details Verified!');
                reviewBankDigits.textContent = last4; // Update review section
                showSection(addressConfirmationSection);
                addressCorrectCheckbox.checked = false; // Reset checkbox
                confirmAddressBtn.disabled = true; // Disable button
            } else {
                showMessage('Incorrect last 4 digits. Please try again.', true);
            }
        });

        backToEligibilityFromBankBtn.addEventListener('click', () => {
            showSection(marriageWithdrawalEligibilitySection);
        });

        // Address Confirmation Logic
        addressCorrectCheckbox.addEventListener('change', () => {
            confirmAddressBtn.disabled = !addressCorrectCheckbox.checked;
        });

        confirmAddressBtn.addEventListener('click', () => {
            if (addressCorrectCheckbox.checked) {
                showMessage('Address Confirmed!');
                reviewAddress.textContent = 'Flat 101, Green Apartments, Cyber City, Bengaluru, Karnataka - 560001'; // Dummy address
                reviewWithdrawalAmount.textContent = `‚Çπ ${finalRequestedWithdrawalAmount.toLocaleString('en-IN', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                showSection(reviewAndSubmitSection);
                termsCheckbox.checked = false; // Reset terms checkbox
                submitClaimBtn.disabled = true; // Disable submit button
            } else {
                showMessage('Please confirm your address to proceed.', true);
            }
        });

        backToBankFromAddressBtn.addEventListener('click', () => {
            showSection(bankDetailsConfirmationSection);
        });

        // Review and Submit Logic
        termsCheckbox.addEventListener('change', () => {
            submitClaimBtn.disabled = !termsCheckbox.checked;
        });

        submitClaimBtn.addEventListener('click', () => {
            if (termsCheckbox.checked) {
                // Simulate claim submission
                const acknowledgment = 'PFSAATHI' + Math.floor(Math.random() * 100000);
                acknowledgmentNumberSpan.textContent = acknowledgment;
                showMessage('Claim Submission in Progress...');
                setTimeout(() => {
                    showSection(claimSubmissionSuccessSection);
                    showMessage('Claim Submitted Successfully!', false);
                }, 1500); // Simulate network delay
            } else {
                showMessage('Please agree to the terms and conditions.', true);
            }
        });

        backToAddressFromReviewBtn.addEventListener('click', () => {
            showSection(addressConfirmationSection);
        });

        // Claim Submission Success Logic
        backToHomeFromSuccessBtn.addEventListener('click', () => {
            showSection(landingPageContent);
        });

        // Event listener for Back to Home button from PF Data Score section
        backToHomeFromDataScoreBtn.addEventListener('click', () => {
            showSection(landingPageContent);
        });

        // New: Event listener for Back to Home button from Balance Only section
        backToHomeFromBalanceOnlyBtn.addEventListener('click', () => {
            showSection(landingPageContent);
        });

        // Event listener for Fix Data Now button
        fixDataNowBtn.addEventListener('click', () => {
            showSection(dataMismatchFixSection);
            correctedFatherNameInput.value = ''; // Clear input
        });

        // Event listener for Back to Data Score button from Fix Data Mismatch
        backToDataScoreFromFixBtn.addEventListener('click', () => {
            showSection(pfDataScoreSection);
        });

        // Event listener for Submit PAN Update Request button
        submitPanUpdateBtn.addEventListener('click', () => {
            const correctedName = correctedFatherNameInput.value;
            if (!correctedName) {
                showMessage('Please enter the corrected father\'s name.', true);
                return;
            }
            showMessage('Submitting PAN update request...', false);
            setTimeout(() => {
                showSection(panUpdateSuccessSection);
                showMessage('PAN Update Request Submitted Successfully!', false);
            }, 1500); // Simulate service call
        });

        // Event listener for Back to Home button from PAN Update Success
        backToHomeFromPanSuccessBtn.addEventListener('click', () => {
            showSection(landingPageContent);
        });

        // Initialize the page on load
        document.addEventListener('DOMContentLoaded', () => {
            showSection(landingPageContent); // Ensure landing page is shown first
        });
    </script>
</body>
</html>
